#
# Example output for updating DragonFly BSD from master on 20180206 to the latest master
# 2018-04-16
#

vultr# ./dfly-update fly
Checking status ...
Fetch remote systems checksum: https://mirror-master.dragonflybsd.org/snapshots/x86_64/images/CHECKSUM.MD5
Local installed system:
    branch: DEVELOPMENT
    version: 5.1.0.884.g8095c

Remote available system:
    branch: DEVELOPMENT
    version: v5.3.0.110.g8296de
    filename: DragonFly-x86_64-20180415-DEV-v5.3.0.110.g8296de.img.bz2
    md5: d2b5f612c8568d8cce6078d1294e7875

!!! Your DragonFly needs update !!!

Downloading the new system image ...
  <= https://mirror-master.dragonflybsd.org/snapshots/x86_64/images/DragonFly-x86_64-20180415-DEV-v5.3.0.110.g8296de.img.bz2
  => /var/tmp/dfly-update/DragonFly-x86_64-20180415-DEV-v5.3.0.110.g8296de.img.bz2
DONE
MD5 checking file ... OK
Decompressing file: /var/tmp/dfly-update/DragonFly-x86_64-20180415-DEV-v5.3.0.110.g8296de.img.bz2 ... DONE
Mounting image /var/tmp/dfly-update/DragonFly-x86_64-20180415-DEV-v5.3.0.110.g8296de.img to /mnt/dfly-update ...
/dev/vn0: /var/tmp/dfly-update/DragonFly-x86_64-20180415-DEV-v5.3.0.110.g8296de.img, complete file mapped
DONE
Backing up current kernel to /boot/kernel.old ...
DONE
Backing up current world to /var/backups/dfly-update/world.tar.gz ...
DONE
Installing the new kernel and world ...
  => Backing up the files to protect from overriding ...
   * /boot/loader.conf  <backed>
   * /etc/fstab  <backed>
   * /etc/group  <backed>
   * /etc/localtime  <backed>
   * /etc/master.passwd  <backed>
   * /etc/passwd  <backed>
   * /etc/pwd.db  <backed>
   * /etc/rc.conf  <backed>
   * /etc/spwd.db  <backed>
  => Creating distribution directories ...
./net/dummynet3 missing (created)
./net/ipfw3 missing (created)
./net/ipfw3_basic missing (created)
./net/ipfw3_layer2 missing (created)
./net/ipfw3_layer4 missing (created)
./net/ipfw3_nat missing (created)
  => Installing kernel and world ...
   * Installing: COPYRIGHT ... ok
   * Installing: bin ... ok
   * Installing: boot ... ok
   * Installing: compat ... ok
   * Installing: lib ... ok
   * Installing: libexec ... ok
   * Installing: sbin ... ok
   * Installing: usr/Makefile ... ok
   * Installing: usr/bin ... ok
   * Installing: usr/games ... ok
   * Installing: usr/include ... ok
   * Installing: usr/lib ... ok
   * Installing: usr/libdata ... ok
   * Installing: usr/libexec ... ok
   * Installing: usr/sbin ... ok
   * Installing: usr/share ... ok
   * Installing: var/msgs ... ok
   * Installing: var/yp ... ok
  => Recovering the backed files ...
   * /boot/loader.conf  <recovered>
   * /etc/fstab  <recovered>
   * /etc/group  <recovered>
   * /etc/localtime  <recovered>
   * /etc/master.passwd  <recovered>
   * /etc/passwd  <recovered>
   * /etc/pwd.db  <recovered>
   * /etc/rc.conf  <recovered>
   * /etc/spwd.db  <recovered>
  => DONE!
Upgrading system ...
  => Coping new /etc to: /var/tmp/dfly-update/etc.new
  => Removing ignored files ...
   * /var/tmp/dfly-update/etc.new/group  <ignored>
   * /var/tmp/dfly-update/etc.new/master.passwd  <ignored>
   * /var/tmp/dfly-update/etc.new/passwd  <ignored>
   * /var/tmp/dfly-update/etc.new/pwd.db  <ignored>
   * /var/tmp/dfly-update/etc.new/rc.conf  <ignored>
   * /var/tmp/dfly-update/etc.new/spwd.db  <ignored>
  => Identifying new/updated config files ...
   * /var/tmp/dfly-update/etc.new/autofs/special_media  [UPDATED]
   * /var/tmp/dfly-update/etc.new/csh.cshrc  [UPDATED]
   * /var/tmp/dfly-update/etc.new/defaults/mkinitrd.conf  [UPDATED]
   * /var/tmp/dfly-update/etc.new/defaults/periodic.conf  [UPDATED]
   * /var/tmp/dfly-update/etc.new/defaults/rc.conf  [UPDATED]
   * /var/tmp/dfly-update/etc.new/devd/usb.conf  [UPDATED]
   * /var/tmp/dfly-update/etc.new/locate.rc  [UPDATED]
   * /var/tmp/dfly-update/etc.new/mail/aliases  [UPDATED]
   * /var/tmp/dfly-update/etc.new/mail/mailer.conf  [UPDATED]
   * /var/tmp/dfly-update/etc.new/mail/mailer.conf.postfix  [UPDATED]
   * /var/tmp/dfly-update/etc.new/motd  [UPDATED]
   * /var/tmp/dfly-update/etc.new/mtree/BSD.include.dist  [UPDATED]
   * /var/tmp/dfly-update/etc.new/newsyslog.conf  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/100.clean-disks  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/110.clean-tmps  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/120.clean-preserve  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/130.clean-msgs  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/140.clean-rwho  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/150.clean-hoststat  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/160.clean-hammer  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/161.clean-hammer2  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/200.backup-passwd  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/210.backup-aliases  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/300.calendar  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/310.accounting  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/330.news  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/400.status-disks  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/420.status-network  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/430.status-uptime  [NEW]
   * /var/tmp/dfly-update/etc.new/periodic/daily/440.status-mailq  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/450.status-security  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/460.status-mail-rejects  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/500.queuerun  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/999.local  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/monthly/200.accounting  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/monthly/450.status-security  [NEW]
   * /var/tmp/dfly-update/etc.new/periodic/monthly/999.local  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/security/100.chksetuid  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/security/110.neggrpperm  [NEW]
   * /var/tmp/dfly-update/etc.new/periodic/security/200.chkmounts  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/security/300.chkuid0  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/security/400.passwdless  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/security/410.logincheck  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/security/500.ipfwdenied  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/security/520.pfdenied  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/security/550.ipfwlimit  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/security/600.ip6fwdenied  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/security/650.ip6fwlimit  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/security/700.kernelmsg  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/security/800.loginfail  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/security/900.tcpwrap  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/security/security.functions  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/weekly/310.locate  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/weekly/320.whatis  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/weekly/340.noid  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/weekly/450.status-security  [NEW]
   * /var/tmp/dfly-update/etc.new/periodic/weekly/999.local  [UPDATED]
   * /var/tmp/dfly-update/etc.new/pf.conf  [UPDATED]
   * /var/tmp/dfly-update/etc.new/rc.d/accounting  [UPDATED]
   * /var/tmp/dfly-update/etc.new/rc.d/btconfig  [UPDATED]
   * /var/tmp/dfly-update/etc.new/rc.d/bthcid  [UPDATED]
   * /var/tmp/dfly-update/etc.new/rc.d/cryptdisks  [UPDATED]
   * /var/tmp/dfly-update/etc.new/rc.d/ipfw3  [NEW]
   * /var/tmp/dfly-update/etc.new/rc.d/lvm  [UPDATED]
   * /var/tmp/dfly-update/etc.new/rc.d/sdpd  [UPDATED]
   * /var/tmp/dfly-update/etc.new/rc.resume  [UPDATED]
   * /var/tmp/dfly-update/etc.new/rc.subr  [UPDATED]
   * /var/tmp/dfly-update/etc.new/rc.suspend  [UPDATED]
   * /var/tmp/dfly-update/etc.new/shells  [UPDATED]
   * /var/tmp/dfly-update/etc.new/ssh/sshd_config  [UPDATED]
   * /var/tmp/dfly-update/etc.new/sysctl.conf  [UPDATED]
   * /var/tmp/dfly-update/etc.new/syslog.conf  [UPDATED]
   * /var/tmp/dfly-update/etc.new/upgrade/Makefile_upgrade.inc  [UPDATED]
  => Installing new configurations ...
  => DONE!
+---------+
| WARNING | Files with '__new__' suffix need manual merge!
+---------+
Removing obsolete and deprecated files ...
  * /boot/efiboot.img
  * /usr/sbin/dfuibe_installer
  * /usr/sbin/dfuife_curses
  * /usr/sbin/installer
  * /usr/share/installer/cmdnames.conf
  * /usr/share/installer/fred.txt
  * /usr/share/installer/sources.conf
  * /usr/share/man/man8/installer.8.gz
DONE
Umounting image from /mnt/dfly-update ... DONE
Disable and unconfigure VN device vn0 ... 
/dev/vn0: cleared
DONE
Removed image file: /build/var.tmp/dfly-update/DragonFly-x86_64-20180415-DEV-v5.3.0.110.g8296de.img
+=========================================================+
The following config files need manual merge:
+---------------------------------------------------------+
/etc/autofs/special_media.__new__
/etc/csh.cshrc.__new__
/etc/defaults/mkinitrd.conf.__new__
/etc/defaults/periodic.conf.__new__
/etc/defaults/rc.conf.__new__
/etc/devd/usb.conf.__new__
/etc/locate.rc.__new__
/etc/mail/aliases.__new__
/etc/mail/mailer.conf.__new__
/etc/mail/mailer.conf.postfix.__new__
/etc/motd.__new__
/etc/mtree/BSD.include.dist.__new__
/etc/newsyslog.conf.__new__
/etc/periodic/daily/100.clean-disks.__new__
/etc/periodic/daily/110.clean-tmps.__new__
/etc/periodic/daily/120.clean-preserve.__new__
/etc/periodic/daily/130.clean-msgs.__new__
/etc/periodic/daily/140.clean-rwho.__new__
/etc/periodic/daily/150.clean-hoststat.__new__
/etc/periodic/daily/160.clean-hammer.__new__
/etc/periodic/daily/161.clean-hammer2.__new__
/etc/periodic/daily/200.backup-passwd.__new__
/etc/periodic/daily/210.backup-aliases.__new__
/etc/periodic/daily/300.calendar.__new__
/etc/periodic/daily/310.accounting.__new__
/etc/periodic/daily/330.news.__new__
/etc/periodic/daily/400.status-disks.__new__
/etc/periodic/daily/420.status-network.__new__
/etc/periodic/daily/440.status-mailq.__new__
/etc/periodic/daily/450.status-security.__new__
/etc/periodic/daily/460.status-mail-rejects.__new__
/etc/periodic/daily/500.queuerun.__new__
/etc/periodic/daily/999.local.__new__
/etc/periodic/monthly/200.accounting.__new__
/etc/periodic/monthly/999.local.__new__
/etc/periodic/security/100.chksetuid.__new__
/etc/periodic/security/200.chkmounts.__new__
/etc/periodic/security/300.chkuid0.__new__
/etc/periodic/security/400.passwdless.__new__
/etc/periodic/security/410.logincheck.__new__
/etc/periodic/security/500.ipfwdenied.__new__
/etc/periodic/security/520.pfdenied.__new__
/etc/periodic/security/550.ipfwlimit.__new__
/etc/periodic/security/600.ip6fwdenied.__new__
/etc/periodic/security/650.ip6fwlimit.__new__
/etc/periodic/security/700.kernelmsg.__new__
/etc/periodic/security/800.loginfail.__new__
/etc/periodic/security/900.tcpwrap.__new__
/etc/periodic/security/security.functions.__new__
/etc/periodic/weekly/310.locate.__new__
/etc/periodic/weekly/320.whatis.__new__
/etc/periodic/weekly/340.noid.__new__
/etc/periodic/weekly/999.local.__new__
/etc/pf.conf.__new__
/etc/rc.d/accounting.__new__
/etc/rc.d/btconfig.__new__
/etc/rc.d/bthcid.__new__
/etc/rc.d/cryptdisks.__new__
/etc/rc.d/lvm.__new__
/etc/rc.d/sdpd.__new__
/etc/rc.resume.__new__
/etc/rc.subr.__new__
/etc/rc.suspend.__new__
/etc/shells.__new__
/etc/ssh/sshd_config.__new__
/etc/sysctl.conf.__new__
/etc/syslog.conf.__new__
/etc/upgrade/Makefile_upgrade.inc.__new__
+---------------------------------------------------------+
After manually merge the above files, reboot into the new
system, and upgrade the packages with:
    # pkg upgrade -f
+=========================================================+

