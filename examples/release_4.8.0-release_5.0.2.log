#
# Example output for updating DragonFly BSD from 4.8.0-RELEASE to 5.0.2-RELEASE
# 2018-03-20
#

dfly# ./dfly-update fly
Checking status ...
Fetch remote systems checksum: https://mirror-master.dragonflybsd.org/iso-images/md5.txt
Local installed system:
    branch: RELEASE
    version: 4.8.0

Remote available system:
    branch: RELEASE
    version: 5.0.2
    filename: dfly-x86_64-5.0.2_REL.img.bz2
    md5: a02acae53865c80c44159dd49790298b

!!! Your DragonFly needs update !!!

Downloading the new system image ...
  <= https://mirror-master.dragonflybsd.org/iso-images/dfly-x86_64-5.0.2_REL.img.bz2
  => /var/tmp/dfly-update/dfly-x86_64-5.0.2_REL.img.bz2
/var/tmp/dfly-update/dfly-x86_64-5.0.2_REL.img100% of  268 MB 1599 kBps 02m52s
DONE
MD5 checking file ... OK
Decompressing file: /var/tmp/dfly-update/dfly-x86_64-5.0.2_REL.img.bz2 ... DONE
Mounting image /var/tmp/dfly-update/dfly-x86_64-5.0.2_REL.img to /mnt/dfly-update ...
/dev/vn0: /var/tmp/dfly-update/dfly-x86_64-5.0.2_REL.img, complete file mapped
DONE
Backing up current kernel to /boot/kernel.old ...
DONE
Backing up current world to /var/backups/dfly-update/world.tar.gz ...
DONE
Installing the new kernel and world ...
  => Backing up the files to protect from overriding ...
   * /boot/loader.conf  <backed>
   * /etc/crypttab  <backed>
   * /etc/fstab  <backed>
   * /etc/group  <backed>
   * /etc/localtime  <backed>
   * /etc/master.passwd  <backed>
   * /etc/passwd  <backed>
   * /etc/pwd.db  <backed>
   * /etc/rc.conf  <backed>
   * /etc/spwd.db  <backed>
  => Creating distribution directories ...
proc changed
        permissions expected 0555 found 0755 modified
share/me changed
        user expected 0 found 9 modified
share/nls changed
        user expected 0 found 9 modified
share/nls/el_GR.ISO8859-7 changed
        user expected 0 found 9 modified
share/nls/it_CH.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/ko_KR.eucKR changed
        user expected 0 found 9 modified
share/nls/be_BY.UTF-8 changed
        user expected 0 found 9 modified
share/nls/de_AT.ISO8859-15 changed
        user expected 0 found 9 modified
share/nls/es_ES.ISO8859-15 changed
        user expected 0 found 9 modified
share/nls/uk_UA.UTF-8 changed
        user expected 0 found 9 modified
share/nls/de_DE.ISO8859-15 changed
        user expected 0 found 9 modified
share/nls/fr_BE.ISO8859-15 changed
        user expected 0 found 9 modified
share/nls/et_EE.ISO8859-15 changed
        user expected 0 found 9 modified
share/nls/de_CH.ISO8859-15 changed
        user expected 0 found 9 modified
share/nls/it_IT.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/fr_CH.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/fi_FI.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/fr_FR.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/zh_Hans_CN.UTF-8 changed
        user expected 0 found 9 modified
share/nls/fr_CA.ISO8859-15 changed
        user expected 0 found 9 modified
share/nls/en_US.ISO8859-15 changed
        user expected 0 found 9 modified
share/nls/uk_UA.KOI8-U changed
        user expected 0 found 9 modified
share/nls/C changed
        user expected 0 found 9 modified
share/nls/ko_KR.UTF-8 changed
        user expected 0 found 9 modified
share/nls/pt_BR.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/de_AT.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/ru_RU.KOI8-R changed
        user expected 0 found 9 modified
share/nls/pl_PL.ISO8859-2 changed
        user expected 0 found 9 modified
share/nls/hu_HU.ISO8859-2 changed
        user expected 0 found 9 modified
share/nls/mn_Cyrl_MN.UTF-8 changed
        user expected 0 found 9 modified
share/nls/nl_NL.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/es_ES.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/ja_JP.UTF-8 changed
        user expected 0 found 9 modified
share/nls/pt_PT.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/de_DE.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/fr_BE.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/it_CH.ISO8859-15 changed
        user expected 0 found 9 modified
share/nls/sv_SE.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/zh_Hans_CN.GB2312 changed
        user expected 0 found 9 modified
share/nls/de_CH.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/nb_NO.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/ja_JP.eucJP changed
        user expected 0 found 9 modified
share/nls/zh_Hans_CN.GB18030 changed
        user expected 0 found 9 modified
share/nls/fr_CA.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/en_US.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/sk_SK.ISO8859-2 changed
        user expected 0 found 9 modified
share/nls/gl_ES.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/ca_ES.ISO8859-1 changed
        user expected 0 found 9 modified
share/nls/it_IT.ISO8859-15 changed
        user expected 0 found 9 modified
share/nls/fr_CH.ISO8859-15 changed
        user expected 0 found 9 modified
share/nls/fi_FI.ISO8859-15 changed
        user expected 0 found 9 modified
share/nls/fr_FR.ISO8859-15 changed
        user expected 0 found 9 modified
share/mk changed
        user expected 0 found 9 modified
share/man/man9 changed
        user expected 0 found 9 modified
share/man/man1 changed
        user expected 0 found 9 modified
share/man/man5 changed
        user expected 0 found 9 modified
share/man/man2 changed
        user expected 0 found 9 modified
share/man/man6 changed
        user expected 0 found 9 modified
share/man/man7 changed
        user expected 0 found 9 modified
share/man/man3 changed
        user expected 0 found 9 modified
share/man/man8 changed
        user expected 0 found 9 modified
share/man/man4 changed
        user expected 0 found 9 modified
share/openssl changed
        user expected 0 found 9 modified
share/openssl/man changed
        user expected 0 found 9 modified
share/misc changed
        user expected 0 found 9 modified
./vfs/tmpfs missing (created)
  => Installing kernel and world ...
   * Installing: COPYRIGHT ... ok
   * Installing: bin ... ok
   * Installing: boot ... ok
   * Installing: compat ... ok
   * Installing: lib ... ok
   * Installing: libexec ... ok
   * Installing: sbin ... ok
   * Installing: usr/Makefile ... ok
   * Installing: usr/bin ... ok
   * Installing: usr/games ... ok
   * Installing: usr/include ... ok
   * Installing: usr/lib ... ok
   * Installing: usr/libdata ... ok
   * Installing: usr/libexec ... ok
   * Installing: usr/sbin ... ok
   * Installing: usr/share ... ok
   * Installing: var/msgs ... ok
   * Installing: var/yp ... ok
  => Recovering the backed files ...
   * /boot/loader.conf  <recovered>
   * /etc/crypttab  <recovered>
   * /etc/fstab  <recovered>
   * /etc/group  <recovered>
   * /etc/localtime  <recovered>
   * /etc/master.passwd  <recovered>
   * /etc/passwd  <recovered>
   * /etc/pwd.db  <recovered>
   * /etc/rc.conf  <recovered>
   * /etc/spwd.db  <recovered>
  => DONE!
Upgrading system ...
  => Coping new /etc to: /var/tmp/dfly-update/etc.new
  => Removing ignored files ...
   * /var/tmp/dfly-update/etc.new/group  <ignored>
   * /var/tmp/dfly-update/etc.new/master.passwd  <ignored>
   * /var/tmp/dfly-update/etc.new/passwd  <ignored>
   * /var/tmp/dfly-update/etc.new/pwd.db  <ignored>
   * /var/tmp/dfly-update/etc.new/rc.conf  <ignored>
   * /var/tmp/dfly-update/etc.new/spwd.db  <ignored>
  => Identifying new/updated config files ...
   * /var/tmp/dfly-update/etc.new/csh.logout  [UPDATED]
   * /var/tmp/dfly-update/etc.new/defaults/mkinitrd.conf  [UPDATED]
   * /var/tmp/dfly-update/etc.new/defaults/periodic.conf  [UPDATED]
   * /var/tmp/dfly-update/etc.new/hosts  [UPDATED]
   * /var/tmp/dfly-update/etc.new/inetd.conf  [UPDATED]
   * /var/tmp/dfly-update/etc.new/mail/aliases  [UPDATED]
   * /var/tmp/dfly-update/etc.new/mail/mailer.conf  [UPDATED]
   * /var/tmp/dfly-update/etc.new/motd  [UPDATED]
   * /var/tmp/dfly-update/etc.new/mtree/BSD.include.dist  [UPDATED]
   * /var/tmp/dfly-update/etc.new/mtree/BSD.root.dist  [UPDATED]
   * /var/tmp/dfly-update/etc.new/mtree/BSD.usr.dist  [UPDATED]
   * /var/tmp/dfly-update/etc.new/mtree/BSD.var.dist  [UPDATED]
   * /var/tmp/dfly-update/etc.new/newsyslog.conf  [UPDATED]
   * /var/tmp/dfly-update/etc.new/periodic/daily/161.clean-hammer2  [NEW]
   * /var/tmp/dfly-update/etc.new/pf.conf  [UPDATED]
   * /var/tmp/dfly-update/etc.new/shells  [UPDATED]
   * /var/tmp/dfly-update/etc.new/ssh/moduli  [UPDATED]
   * /var/tmp/dfly-update/etc.new/ssh/ssh_config  [UPDATED]
   * /var/tmp/dfly-update/etc.new/ssh/sshd_config  [UPDATED]
   * /var/tmp/dfly-update/etc.new/sysctl.conf  [UPDATED]
   * /var/tmp/dfly-update/etc.new/syslog.conf  [UPDATED]
   * /var/tmp/dfly-update/etc.new/upgrade/Makefile_upgrade.inc  [UPDATED]
  => Installing new configurations ...
  => DONE!
+---------+
| WARNING | Files with '__new__' suffix need manual merge!
+---------+
Removing obsolete and deprecated files ...
Removing obsolete and deprecated files ...
  * /usr/share/man/man3/archive.3.gz
  * /usr/sbin/dfuibe_installer
  * /usr/sbin/dfuife_curses
  * /usr/sbin/installer
  * /usr/share/installer/cmdnames.conf
  * /usr/share/installer/fred.txt
  * /usr/share/installer/sources.conf
  * /usr/share/man/man8/installer.8.gz
DONE
Umounting image from /mnt/dfly-update ... DONE
Disable and unconfigure VN device vn0 ...
/dev/vn0: cleared
DONE
Removed image file: /pfs/@@-1:00007/dfly-update/dfly-x86_64-5.0.2_REL.img
+=========================================================+
The following config files need manual merge:
+---------------------------------------------------------+
/etc/csh.logout.__new__
/etc/defaults/mkinitrd.conf.__new__
/etc/defaults/periodic.conf.__new__
/etc/hosts.__new__
/etc/inetd.conf.__new__
/etc/mail/aliases.__new__
/etc/mail/mailer.conf.__new__
/etc/motd.__new__
/etc/mtree/BSD.include.dist.__new__
/etc/mtree/BSD.root.dist.__new__
/etc/mtree/BSD.usr.dist.__new__
/etc/mtree/BSD.var.dist.__new__
/etc/newsyslog.conf.__new__
/etc/pf.conf.__new__
/etc/shells.__new__
/etc/ssh/moduli.__new__
/etc/ssh/ssh_config.__new__
/etc/ssh/sshd_config.__new__
/etc/sysctl.conf.__new__
/etc/syslog.conf.__new__
/etc/upgrade/Makefile_upgrade.inc.__new__
+---------------------------------------------------------+
Upgrade the packages by:
    # pkg upgrade -f
+=========================================================+

dfly#
